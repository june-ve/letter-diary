<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>LetterDiary - ë¡œê·¸ì¸</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #e6ddcf; /* ì±…ìƒ ë°°ê²½ í†¤ */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .login-card {
            background: linear-gradient(145deg, #f7f0e7, #f0e0c9);
            padding: 32px 38px;
            border-radius: 18px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            width: 360px;
        }

        .login-title {
            font-size: 22px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 6px;
            color: #3b2f2f;
        }

        .login-subtitle {
            font-size: 14px;
            text-align: center;
            opacity: 0.75;
            margin-bottom: 22px;
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-label {
            font-size: 13px;
            margin-bottom: 6px;
            display: block;
            color: #4a3c3c;
        }

        input[type="email"],
        input[type="password"] {
            width: 100%;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.15);
            background: #fdf7ea;
            font-size: 14px;
        }

        .btn-login {
            width: 100%;
            background: #b56d57;
            border: none;
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-size: 15px;
            cursor: pointer;
            margin-top: 12px;
        }

        .btn-login:hover {
            background: #9e5641;
        }

        .error-message {
            font-size: 13px;
            color: #b74d37;
            margin-top: 8px;
            display: none;
            text-align: center;
        }

        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 18px;
            border-radius: 999px;
            font-size: 13px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(-4px);
        }
    </style>
</head>

<body>

<div class="login-card">
    <div class="login-title">LetterDiary</div>
    <div class="login-subtitle">ë”°ëœ»í•œ ë§ˆìŒì„ ê¸°ë¡í•˜ëŠ” ê³µê°„</div>

    <!-- ë¡œê·¸ì¸ í¼ -->
    <div>
        <div class="input-group">
            <label class="input-label">ì´ë©”ì¼</label>
            <input type="email" id="email" placeholder="your@email.com">
        </div>

        <div class="input-group">
            <label class="input-label">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
        </div>

        <button class="btn-login" id="loginBtn">ë¡œê·¸ì¸</button>

        <div class="error-message" id="errorMessage">ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
    </div>
</div>

<div class="toast" id="toast"></div>

<script>
    const loginBtn = document.getElementById("loginBtn");
    const errorMessage = document.getElementById("errorMessage");
    const toast = document.getElementById("toast");

    function showToast(message) {
        toast.textContent = message;
        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 2000);
    }

    loginBtn.addEventListener("click", async () => {
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();

        if (!email || !password) {
            errorMessage.style.display = "block";
            errorMessage.textContent = "ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
            return;
        }

        try {
            const response = await fetch("/api/auth/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, password })
            });

            if (!response.ok) {
                errorMessage.style.display = "block";
                errorMessage.textContent = "ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
                return;
            }

            const data = await response.json();

            // JWT ì €ì¥
            localStorage.setItem("token", data.token);

            showToast("ë¡œê·¸ì¸ ì„±ê³µ! ì±…ìƒìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤ ğŸ’Œ");

            // 1ì´ˆ í›„ ì±…ìƒ í˜ì´ì§€ë¡œ ì´ë™
            setTimeout(() => {
                window.location.href = "/diary";   // ì±…ìƒ í˜ì´ì§€
            }, 800);

        } catch (err) {
            console.error(err);
            errorMessage.style.display = "block";
            errorMessage.textContent = "ì„œë²„ì™€ ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        }
    });
</script>

</body>
</html>
